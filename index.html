<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>L'ALCHIMISTE - Gestion des Réservations</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 10px; }
        h1 { font-size: 24px; font-weight: bold; }
        .plan-container {
            position: relative;
            width: 800px;
            height: 600px;
            margin: auto;
            background: url('/mnt/data/plan_vierge_grand.JPEG.jpg') no-repeat center;
            background-size: contain;
        }
        .table {
            position: absolute;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 5px;
            font-weight: bold;
            color: white;
            cursor: pointer;
            border: 2px solid black;
            text-align: center;
            font-size: 0.8rem;
        }
        .reserved { background-color: red; }
        .pending { background-color: orange; }
        .free { background-color: green; }
        .reservation-info {
            margin-top: 20px;
            padding: 10px;
            border: 1px solid black;
            display: inline-block;
            background-color: #f9f9f9;
        }
    </style>
</head>
<body>
    <h1>L'ALCHIMISTE</h1>
    <h2>Gestion des Réservations</h2>
    
    <div class="plan-container" id="plan-container"></div>
    
    <div class="reservation-info" id="reservation-info">
        <h3>Détails de la Réservation</h3>
        <p id="info-text">Cliquez sur une table pour voir les informations.</p>
    </div>
    
    <script>
        const tablePositions = [
            { number: 1, left: '90%', top: '5%' }, { number: 2, left: '85%', top: '5%' }, { number: 3, left: '80%', top: '5%' }, { number: 4, left: '75%', top: '5%' },
            { number: 5, left: '65%', top: '5%' }, { number: 6, left: '60%', top: '5%' }, { number: 7, left: '55%', top: '5%' },
            { number: 8, left: '90%', top: '20%' }, { number: 9, left: '85%', top: '20%' }, { number: 10, left: '80%', top: '20%' },
            { number: 20, left: '60%', top: '20%' }, { number: 21, left: '55%', top: '20%' }, { number: 22, left: '55%', top: '30%' }, { number: 23, left: '60%', top: '30%' },
            { number: 24, left: '45%', top: '20%' }, { number: 25, left: '45%', top: '27%' }, { number: 26, left: '45%', top: '34%' }, { number: 27, left: '45%', top: '41%' },
            { number: 28, left: '45%', top: '48%' }, 
            { number: 40, left: '45%', top: '60%' }, { number: 41, left: '45%', top: '67%' }, { number: 42, left: '45%', top: '74%' }, 
            { number: 43, left: '55%', top: '60%' },{ number: 44, left: '60%', top: '60%' },{ number: 45, left: '65%', top: '60%' }, { number: 46, left: '75%', top: '60%' },
            { number: 47, left: '75%', top: '70%' }, { number: 48, left: '60%', top: '70%' }, { number: 49, left: '55%', top: '70%' },
            { number: 30, left: '35%', top: '5%' }, { number: 31, left: '30%', top: '5%' }, { number: 32, left: '25%', top: '5%' },
            { number: 33, left: '25%', top: '15%' }, { number: 34, left: '25%', top: '22%' }, 
            { number: 35, left: '25%', top: '29%' }, 
            { number: 51, left: '25%', top: '38%' }, { number: 52, left: '25%', top: '45%' }, { number: 53, left: '25%', top: '52%' }, 
            { number: 54, left: '25%', top: '67%' }, { number: 55, left: '25%', top: '74%' },
            { number: 36, left: '30%', top: '29%' },{ number: 50, left: '30%', top: '38%' },{ number: 56, left: '30%', top: '74%' },
        ];

        let tablesData = JSON.parse(localStorage.getItem("tablesData")) || tablePositions.map(t => ({ number: t.number, status: "L", name: "", time: "", people: 0, deposit: 0 }));

        function renderTables() {
            const container = document.getElementById("plan-container");
            container.innerHTML = "";
            tablePositions.forEach(tablePos => {
                let table = tablesData.find(t => t.number === tablePos.number) || { status: "L" };
                const div = document.createElement("div");
                div.className = "table " + (table.status === "R" ? "reserved" : table.status === "Att" ? "pending" : "free");
                div.innerHTML = `${tablePos.number}`;
                div.style.left = tablePos.left;
                div.style.top = tablePos.top;
                div.onclick = () => selectTable(tablePos.number);
                container.appendChild(div);
            });
        }

        function selectTable(tableNumber) {
            let table = tablesData.find(t => t.number === tableNumber);
            if (table) {
                document.getElementById("info-text").innerHTML = `
                    <strong>Table ${table.number}</strong><br>
                    Nom: ${table.name || "Non réservé"}<br>
                    Personnes: ${table.people || "-"}<br>
                    Horaire: ${table.time || "-"}<br>
                    Acompte: ${table.deposit ? table.deposit + "€" : "-"}`;
            }
        }

        window.addEventListener("load", renderTables);
    </script>
</body>
</html>
